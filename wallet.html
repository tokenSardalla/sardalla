<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sardalla Wallet (SAR) — Keystore manager</title>

  <link rel="stylesheet" href="wallet.css" />

  <style>
    .highlight {
      box-shadow: 0 0 0 3px rgba(255,218,26,0.18), 0 8px 20px rgba(0,0,0,0.2);
      animation: pulse 1.6s infinite;
    }
    @keyframes pulse {
      0% { transform: translateY(0); }
      50% { transform: translateY(-2px); }
      100% { transform: translateY(0); }
    }
    .toast {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 20px;
      background: #0b3b6f;
      color: #fff;
      padding: 10px 18px;
      border-radius: 8px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      z-index: 2000;
      display: none;
      font-family: inherit;
    }
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(4,12,28,0.6);
      z-index: 2500;
      display: none;
      align-items: center;
      justify-content: center;
    }
    .modal {
      background: linear-gradient(180deg, #0f2b56, #071733);
      border-radius: 12px;
      padding: 18px;
      width: 420px;
      max-width: calc(100% - 32px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.6);
      color: #fff;
    }
    .modal h3 { margin: 0 0 8px 0; font-size: 18px; }
    .modal p { margin: 0 0 12px 0; color: #cfe3ff; font-size: 13px; }
    .modal .modal-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:12px; }

    .badge-saved {
      background: #ffda1a;
      color: #05203a;
      padding: 2px 8px;
      font-size: 11px;
      border-radius: 999px;
      margin-left: 8px;
      font-weight:700;
    }

    /* Overlay saving */
    #savingOverlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.55);
      z-index: 3000;
      color: white;
      font-size: 22px;
      font-weight: bold;
      backdrop-filter: blur(4px);
    }
  </style>
</head>

<body>

<div class="wallet-wrap">

  <header class="wallet-header">
    <a class="brand" href="index.html">
      <img src="logo_sardalla_96px.webp" alt="Sardalla Logo" />
      <div>
        <div class="brand-title">Sardalla <span class="accent">Wallet</span></div>
        <div class="brand-sub">Self-custody — Keystore manager</div>
      </div>
    </a>

    <div class="header-actions">
      <a class="btn secondary" href="index.html">Home</a>
      <a class="btn secondary" href="mailto:sardalla@sardalla.com">Support</a>
    </div>
  </header>

  <div class="wallet-main">

    <div class="card card-left">

      <h2>Create Wallet</h2>
      <p class="muted">Generate a new Sardalla self-custody wallet.  
      To save it here you must create a keystore password —  
      the app will store only the encrypted keystore JSON.</p>

      <button class="btn primary full" id="createWalletBtn">Create New Wallet</button>
      <button class="btn outline full" id="cancelCreateBtn" style="display:none; margin-top:8px;">Cancel</button>

      <!-- Mnemonic Block -->
      <div id="mnemonicBox" style="display:none; margin-top:16px;">

        <h2>Recovery Phrase (NOT stored)</h2>
        <p style="color:#ffda1a; font-weight:600;">⚠ IMPORTANT — This phrase gives full access to your wallet.</p>
        <p style="color:#ffaaaa;">The mnemonic will <b>not</b> be stored in the browser.</p>

        <div id="phraseSection">
          <textarea id="mnemonicDisplay" rows="3" style="width:100%; font-size:16px; padding:8px; display:none;" readonly></textarea>

          <div style="margin-top:8px; display:flex; gap:8px;">
            <button class="btn secondary" id="showMnemonicBtn">Show Phrase</button>
            <button class="btn outline" id="copyMnemonicBtn" style="display:none;">Copy</button>
            <button class="btn primary" id="mnemonicOkBtn" style="display:none;">I Saved It</button>
          </div>
        </div>

        <div style="margin-top:12px;">
          <label style="font-size:13px;color:var(--muted)">Name this wallet</label>
          <input id="walletNameInput" placeholder="Wallet name" class="p-2" style="width:100%; margin-top:6px;" />

          <label style="font-size:13px;color:var(--muted); margin-top:10px; display:block;">Password to encrypt keystore</label>
          <input id="saveKeystorePwd" type="password" placeholder="Min. 8 chars" class="p-2" style="width:100%; margin-top:6px;" />

          <div style="display:flex; gap:8px; margin-top:8px;">
            <button class="btn full" id="saveKeystoreBtn" disabled>Encrypt & Save Keystore</button>
            <button class="btn outline full" id="downloadMnemonicBtn">Download Mnemonic (txt)</button>
          </div>

          <div id="saveHint" style="margin-top:10px; color:#ccc; font-size:13px; display:none;">
            <strong>Step 4 — Save keystore:</strong>  
            If you leave the page without saving, the wallet will be lost.
          </div>
        </div>
      </div>

      <div class="address-block" style="margin-top:18px;">
        <div class="address-label">Loaded Address:</div>
        <div class="address-row"><code id="walletAddress">—</code></div>
      </div>

      <h2>Your Saved Wallets</h2>
      <div id="walletList" style="margin-top:8px;"></div>
      <button class="btn outline" id="clearAllBtn" style="margin-top:10px;">Clear All</button>

    </div>

    <div class="card card-right">

      <h2>Balances</h2>
      <div class="balances-grid">
        <div><div class="balance-label">BNB</div><div class="balance-value" id="bnbBalance">0</div></div>
        <div><div class="balance-label">SAR</div><div class="balance-value" id="sarBalance">0</div></div>
      </div>

      <h2 style="margin-top:20px;">Send SAR</h2>
      <input id="sendTo" placeholder="Recipient address" class="p-2" style="width:100%;" />
      <input id="sendAmt" placeholder="Amount" class="p-2" style="width:100%; margin-top:8px;" />
      <button class="btn primary full" id="sendSarBtn">Send</button>

      <h2 style="margin-top:26px;">Import Wallet</h2>

      <label style="font-size:13px;color:var(--muted)">Import mnemonic (converted to keystore)</label>
      <textarea id="importMnemonic" rows="2" class="p-2" placeholder="seed phrase"></textarea>
      <input id="importName" class="p-2" placeholder="Optional name" style="margin-top:8px;" />
      <input id="importMnemonicPwd" type="password" class="p-2" placeholder="Keystore password" style="margin-top:8px;" />
      <button class="btn secondary full" id="importMnemonicBtn" style="margin-top:8px;">Import mnemonic → keystore</button>

      <hr style="margin:16px 0; border-color:#1e2c4d;" />

      <textarea id="importJson" rows="3" class="p-2" placeholder="Paste keystore JSON"></textarea>
      <input id="importJsonName" class="p-2" placeholder="Wallet name" style="margin-top:8px;" />
      <button class="btn outline full" id="importKeystoreBtn" style="margin-top:8px;">Import Keystore JSON</button>

      <div class="token-info" style="margin-top:20px;">
        <div class="token-row"><span class="token-label">Token:</span> Sardalla (SAR)</div>
        <div class="token-row"><span class="token-label">Network:</span> BSC Mainnet</div>
        <div class="token-row"><span class="token-label">Contract:</span> 0x851d720513fF135007dE95bd58B28514093bEb25</div>
      </div>

    </div>
  </div>

  <div class="status-row" id="walletStatus">Ready.</div>

  <footer class="wallet-footer">
    <span>© 2025–2027 Sardalla (SAR)</span>
    <a href="mailto:sardalla@sardalla.com">Contact</a>
    <a href="index.html">Website</a>
  </footer>

</div>

<div id="toast" class="toast"></div>

<div id="savingOverlay">Saving wallet…</div>

<!-- Unlock Modal -->
<div id="modalBackdrop" class="modal-backdrop">
  <div class="modal">
    <h3>Unlock Wallet</h3>
    <p>Enter password to unlock your keystore.</p>
    <input id="unlockPasswordInput" type="password" class="p-2" placeholder="Password" style="width:100%;" />
    <div class="modal-actions">
      <button class="btn" id="unlockCancel">Cancel</button>
      <button class="btn primary" id="unlockConfirm">Unlock Wallet</button>
    </div>
  </div>
</div>

<!-- QR + Ethers + JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<script src="wallet.js"></script>
</body>
</html>


